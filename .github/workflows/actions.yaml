name: build
on: push

defaults:
  run:
    shell: bash

jobs:
  compile:

    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v2
      - name: Prepare Java
        uses: actions/setup-java@v1
        with:
          java-version: 1.8
      - name: Install clojure tools-deps
        uses: DeLaGuardo/setup-clojure@master
        with:
          cli: 1.10.1.693
      - name: Compile
        run: make

  run-tests:
    runs-on: ubuntu-latest
    steps:
      - uses: liquidz/babashka-test-action@v1
        with:
          source-paths: 'src'
          test-paths: 'test/matr_core'
          test-file-pattern: '_test.clj$'
